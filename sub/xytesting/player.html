<!DOCTYPE html>
<html>
<head>
    <title>PsyduckAnime - best place to watch Pokemon subbed and dubbed</title>
    <meta content="Psyduckanime - testing page" property="og:title"/>
    <meta content="https://psyduckanime.lol/Psyduck.png" property="og:image"/>
    <!-- Favicon -->
    <link href="https://psyduckanime.lol/Psyduck.png" rel="icon"/>
    <script src="https://cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js" type="text/javascript"></script>
    <style>
        body {
            padding: 25px;
            background-color: white;
            color: #424242;
            font-size: 25px;
        }
        .dark-mode {
            background-color: #424242;
            color: white;
        }
        .light-mode {
            background-color: white;
            color: #424242;
        }
    </style>
</head>
<body class="dark-mode">
    <div class="top-bar">
        <a href="https://snowythevulpix.github.io/redirect" title="Go to Home">
            <img alt="Logo" class_="logo" src="https://psyduckanime.lol/Psyduck.png" style="width: 40px; height: 40px; padding: 5px; cursor: pointer;"/>
        </a>
        PsyduckAnime - watch Pokemon subbed and dubbed for free
    </div>

    <div id="episode-container"></div>
    <div id="player"></div>

    <script>
        var epUrl; // Declare epUrl at the top level

        async function fetchData() {
            try {
                const id = "19291";
                const episodeData = await (await fetch(`https://api.anify.tv/episodes/${id}`)).json();
                const episodes = episodeData.filter((provider) => provider.providerId === "animepahe")[0]?.episodes;

                const ep = episodes[0];
                const sources = await (await fetch(`https://api.anify.tv/sources?providerId=animepahe&watchId=${ep.id}&episodeNumber=${ep.number}&id=${id}&subType=${ep.hasDub ? "dub" : "sub"}&server=kwik`)).json();

                if (sources.sources && sources.sources.length > 0) {
                    epUrl = sources.sources[0].url; // Assign the URL value to the global variable epUrl
                    console.log("URL obtained:", epUrl);

                    // You can use the 'epUrl' variable for further processing.
                    var player = new Clappr.Player({ source: epUrl, parentId: "#player" });
                } else {
                    console.log("No sources found.");
                }
            } catch (error) {
                console.error(`Error fetching data: ${error.message}`);
            }
        }

        fetchData(); // Call the async function to fetch data
    </script>

    <!-- Your other HTML code -->

    <button onclick="darkMode()">Dark Mode</button>
    <button onclick="lightMode()">Light Mode</button>

    <script>
        function darkMode() {
            var element = document.body;
            element.className = "dark-mode";
        }
        function lightMode() {
            var element = document.body;
            element.className = "light-mode";
        }
    </script>
</body>
</html>
