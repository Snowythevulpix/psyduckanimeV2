<!DOCTYPE html>
<html>
<head>
    <title>PsyduckAnime - best place to watch pokemon subbed and dubbed</title>
    <meta content="Psyduckanime - testing page" property="og:title"/>
    <meta content="https://m.media-amazon.com/images/M/MV5BMGNjMmFlYWUtMTBjNS00YzdlLTk3NzktZjFjMjZlMWFiODUyXkEyXkFqcGdeQXVyOTA1ODU0Mzc@._V1_FMjpg_UX1000_.jpg" property="og:image"/>
    <!-- Favicon -->
    <link href="https://m.media-amazon.com/images/M/MV5BMGNjMmFlYWUtMTBjNS00YzdlLTk3NzktZjFjMjZlMWFiODUyXkEyXkFqcGdeQXVyOTA1ODU0Mzc@._V1_FMjpg_UX1000_.jpg" rel="icon"/>
    <script src="https://cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js" type="text/javascript"></script>
</head>
<body>
    <div id="episode-container"></div>
    <script>
        document.addEventListener("DOMContentLoaded", async function () {
            const episodeContainer = document.getElementById("episode-container");

            // Function to fetch episode data and play using Clappr player
            async function loadAndPlayEpisode(episodeId) {
                try {
                    // Fetch episode data for the given episode ID
                    const response = await fetch(`https://psyduckanime.xyz/anime/gogoanime/watch/pokemon-shinsaku-anime-episode-${episodeId}`);
                    if (!response.ok) {
                        console.log(`Failed to fetch episode data for episode ${episodeId}`);
                        return;
                    }
                    const data = await response.json();
                    const title = data.title;

                    // Find the 1080p video URL from the episode data
                    const video1080p = data.sources.find(source => source.quality === "1080p");

                    if (video1080p) {
                        // Create a container for the episode
                        const episodeElement = document.createElement("div");
                        episodeElement.id = `episode-${episodeId}`;

                        // Create a header with the episode title
                        const episodeHeader = document.createElement("h2");
                        episodeHeader.textContent = `Episode ${episodeId} - ${title}`;
                        episodeElement.appendChild(episodeHeader);

                        // Append the episode container to the main container
                        episodeContainer.appendChild(episodeElement);

                        // Initialize Clappr player for the episode
                        const player = new Clappr.Player({
                            source: video1080p.url,
                            parentId: `#episode-${episodeId}`,
                        });
                    } else {
                        console.log(`1080p video for episode ${episodeId} not available.`);
                    }
                } catch (error) {
                    console.log(`Error loading episode ${episodeId}: ${error.message}`);
                }
            }

            // Determine the total number of episodes dynamically
            const response = await fetch('https://psyduckanime.xyz/anime/gogoanime/info/pokemon-shinsaku-anime');
            if (response.ok) {
                const data = await response.json();
                const totalEpisodes = data.totalEpisodes;

                // Check if a specific episode is specified in the URL's fragment identifier
                const fragmentIdentifier = window.location.hash;
                if (fragmentIdentifier) {
                    const episodeId = parseInt(fragmentIdentifier.substring(1)); // Remove the '#' and convert to integer
                    if (!isNaN(episodeId) && episodeId >= 1 && episodeId <= totalEpisodes) {
                        loadAndPlayEpisode(episodeId);
                        return; // Stop execution, as we've loaded the specified episode
                    }
                }

                // Load and play data for each episode in ascending order with a delay
                for (let episodeId = 1; episodeId <= totalEpisodes; episodeId++) {
                    setTimeout(() => loadAndPlayEpisode(episodeId), episodeId * 1000); // Delay in milliseconds
                }
            } else {
                episodeContainer.innerHTML = '<p>Failed to fetch total episodes data.</p>';
            }
        });
    </script>
</body>
</html>
