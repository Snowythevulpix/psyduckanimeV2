<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>PsyduckAnime - best place to watch Pokemon subbed and dubbed</title>
    <meta property="og:title" content="Psyduckanime - watch Pokemon for free"/>
    <meta property="og:image" content="https://m.media-amazon.com/images/M/MV5BMGNjMmFlYWUtMTBjNS00YzdlLTk3NzktZjFjMjZlMWFiODUyXkEyXkFqcGdeQXVyOTA1ODU0Mzc@._V1_FMjpg_UX1000_.jpg"/>
    <!-- Favicon -->
    <link rel="icon" href="https://m.media-amazon.com/images/M/MV5BMGNjMmFlYWUtMTBjNS00YzdlLTk3NzktZjFjMjZlMWFiODUyXkEyXkFqcGdeQXVyOTA1ODU0Mzc@._V1_FMjpg_UX1000_.jpg"/>
    <!-- Font Awesome icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"/>
    <!-- Core theme CSS -->
    <link rel="stylesheet" href="style.css"/>
    <style>
        /* Your custom styles go here */
        .discord-icon {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 32px;
            height: 32px;
            cursor: pointer;
        }

        /* Add this style for the widget */
        .clicky-widget {
            position: fixed;
            top: 10px; /* Adjust the top position as needed */
            right: 10px; /* Adjust the right position as needed */
            z-index: 9999; /* Ensure it's above other elements */
        }

        /* Media query for mobile devices */
        @media (max-width: 768px) {
            .clicky-widget {
                width: 100px; /* Adjust the width for mobile */
                height: 150px; /* Adjust the height for mobile */
            }
        }

        /* Additional custom styles can be added here */
    </style>
</head>
<body class="dark-mode">
    <!-- Discord Icon -->
    <a href="discord.html">
        <img alt="Discord Icon" class="discord-icon" src="discord-icon.png"/>
    </a>

    <!-- Profile Picture (hidden by default) -->
    <img id="profilePicture" alt="Profile Picture" class="clicky-widget" style="display: none;"/>

    <!-- Parallax Pixel Background Animation -->
    <section class="animated-background">
        <div id="stars1"></div>
        <div id="stars2"></div>
        <div id="stars3"></div>
    </section>
    <!-- End of Parallax Pixel Background Animation -->

    <!-- "PsyduckAnime" Text -->
    <div id="userName">PsyduckAnime</div>

    <!-- Links -->
    <div id="links">
        <a class="link" href="sub/home.html" target="_self">sub</a>
    </div>
    <div id="links">
        <a class="link" href="dub/home.html" target="_self">dub</a>
    </div>

    <!-- JavaScript Code -->
    <script>
        // Function to extract the 'code' parameter from the URL
        function extractCodeFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get("code");

            if (code) {
                // Code found in the URL, send it to your backend
                sendCodeToBackend(code);
            } else {
                console.log("No authorization code found in the URL.");
            }
        }

        // Function to send the code to your backend
        function sendCodeToBackend(code) {
            // Define the endpoint of your backend
            const backendEndpoint = 'https://backend.psyduckanime.xyz/route.js'; // Replace with your actual route

            // Create a POST request with the code as the payload
            fetch(backendEndpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ code: code }),
            })
                .then(response => {
                    if (response.ok) {
                        return response.json(); // Parse the response as JSON
                    } else {
                        console.error('Failed to send the authorization code to the backend.');
                    }
                })
                .then(data => {
                    if (data && data.profilePictureUrl) {
                        displayProfilePicture(data.profilePictureUrl);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        // Function to display the profile picture
        function displayProfilePicture(profilePictureUrl) {
            const profileImage = document.getElementById('profilePicture');
            profileImage.src = profilePictureUrl;
            profileImage.style.display = 'block'; // Show the profile picture
        }

        // Call the function when the page loads to extract the code
        extractCodeFromURL();
    </script>
</body>
</html>
